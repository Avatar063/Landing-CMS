<?php foreach($vars['fields'] as $alias => $field): ?>

	<?php
		$field['parents'] = Utils::pr($vars['parents'], array());
		$field['parents'][] = $alias;
		$field['name'] = Content::getNameAsString($field['parents']);
	?>

	<?php if( $field['type'] == 'fields_group' ): ?>

		<div class="form-group">
			<div class="panel panel-default">
				<div class="panel-heading">
					<div class="pull-right panel-controls">
						<a
						 class="icon up-white label label-default"
						 href="?moveFieldUp=<?=$field['name'];?>"
						 title="Move &laquo;<?php echo $field['title']; ?>&raquo; Group Up.">&nbsp;</a>
						<a
						 class="icon down-white label label-default"
						 href="?moveFieldDown=<?=$field['name'];?>"
						 title="Move &laquo;<?php echo $field['title']; ?>&raquo; Group Down.">&nbsp;</a>
						<a
						 class="icon edit-white label label-default"
						 href="<?=Utils::getLink('cms/edit-field/?name='.$field['name']);?>"
						 title="Edit &laquo;<?php echo $field['title']; ?>&raquo; Group.">&nbsp;</a>
						<a
						 class="icon <?=Utils::pr($field['open'])?'collapse':'increase';?> label label-default"
						 href="?<?=Utils::pr($field['open'])?'closeGroup':'openGroup';?>=<?=$field['name'];?>"
						 title="Open/Close &laquo;<?php echo $field['title']; ?>&raquo; Group."
						 onclick="openCloseGroup('<?php echo $field['name']; ?>'); return false;"
						 id="js_group_toggle_<?php echo $field['name']; ?>">&nbsp;</a>
						<a
						 class="icon delete-white label label-danger"
						 href="?delete=<?php echo $field['name']; ?>"
						 title="Delete &laquo;<?php echo $field['title']; ?>&raquo; Group."
						 onclick="return confirm('Do you want to delete &laquo;<?php echo $field['title']; ?>&raquo; Group?')">&nbsp;</a>
					</div>
					<h3 class="panel-title"><?php echo $field['title']; ?></h3>
				</div>
				<div
				 class="panel-body<?=Utils::pr($field['open'])?'':' hidden';?>"
				 id="js_group_body_<?php echo $field['name']; ?>">

					<?php
						$info['parents'] = $field['parents'];
						$info['fields'] = $field['output'];

						echo Utils::render(
							"fields/{$field['type']}.html",
							 $info
						);
					?>

				</div>
			</div>
			<p class="help-block"><?php echo $field['description']; ?></p>
		</div>

	<?php else: ?>

		<div class="form-group">
			<a
			 href="?delete=<?php echo $field['name']; ?>"
			 title="Delete &laquo;<?php echo $field['title']; ?>&raquo; Field."
			 onclick="return confirm('Do you want to delete &laquo;<?php echo $field['title']; ?>&raquo; Field?')">
				<span class="icon delete-red" aria-hidden="true">&nbsp;</span>
			</a>
			<a
			 href="<?=Utils::getLink('cms/edit-field/?name='.$field['name']);?>"
			 title="Edit &laquo;<?php echo $field['title']; ?>&raquo; Field.">
				<span class="icon edit-black" aria-hidden="true">&nbsp;</span>
			</a>
			<a
			 href="?moveFieldDown=<?php echo $field['name']; ?>"
			 title="Move &laquo;<?php echo $field['title']; ?>&raquo; Field Down.">
				<span class="icon down-black" aria-hidden="true">&nbsp;</span>
			</a>
			<a
			 href="?moveFieldUp=<?php echo $field['name']; ?>"
			 title="Move &laquo;<?php echo $field['title']; ?>&raquo; Field Up.">
				<span class="icon up-black" aria-hidden="true">&nbsp;</span>
			</a>
			<?php echo Utils::render(
				"fields/{$field['type']}.html",
				 $field);
			?>
			<p class="help-block"><?php echo $field['description']; ?></p>
		</div>
	<?php endif; ?>

<?php endforeach; ?>